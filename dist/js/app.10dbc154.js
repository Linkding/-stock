(function(t){function e(e){for(var r,i,o=e[0],c=e[1],u=e[2],_=0,d=[];_<o.length;_++)i=o[_],s[i]&&d.push(s[i][0]),s[i]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(t[r]=c[r]);l&&l(e);while(d.length)d.shift()();return a.push.apply(a,u||[]),n()}function n(){for(var t,e=0;e<a.length;e++){for(var n=a[e],r=!0,o=1;o<n.length;o++){var c=n[o];0!==s[c]&&(r=!1)}r&&(a.splice(e--,1),t=i(i.s=n[0]))}return t}var r={},s={app:0},a=[];function i(e){if(r[e])return r[e].exports;var n=r[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=r,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(n,r,function(e){return t[e]}.bind(null,r));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],c=o.push.bind(o);o.push=e,o=o.slice();for(var u=0;u<o.length;u++)e(o[u]);var l=c;a.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"034f":function(t,e,n){"use strict";var r=n("64a9"),s=n.n(r);s.a},"0609":function(t,e,n){},"068a":function(t,e,n){},"10d5":function(t,e,n){},"1d0a":function(t,e,n){"use strict";var r=n("879c"),s=n.n(r);s.a},"3f5d":function(t,e,n){"use strict";var r=n("413b"),s=n.n(r);s.a},"413b":function(t,e,n){},"4aff":function(t,e,n){},"4f0c":function(t,e,n){},"56d7":function(t,e,n){"use strict";n.r(e);var r=n("2b0e"),s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("router-view")],1)},a=[],i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"hello"},[n("h1",[t._v(t._s(t.msg))]),t._m(0),n("h3",[t._v("Installed CLI Plugins")]),t._m(1),n("h3",[t._v("Essential Links")]),t._m(2),n("h3",[t._v("Ecosystem")]),t._m(3)])},o=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("p",[t._v("\n    For guide and recipes on how to configure / customize this project,"),n("br"),t._v("\n    check out the\n    "),n("a",{attrs:{href:"https://cli.vuejs.org",target:"_blank"}},[t._v("vue-cli documentation")]),t._v(".\n  ")])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("ul",[n("li",[n("a",{attrs:{href:"https://github.com/vuejs/vue-cli/tree/dev/packages/%40vue/cli-plugin-babel",target:"_blank"}},[t._v("babel")])]),n("li",[n("a",{attrs:{href:"https://github.com/vuejs/vue-cli/tree/dev/packages/%40vue/cli-plugin-eslint",target:"_blank"}},[t._v("eslint")])])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("ul",[n("li",[n("a",{attrs:{href:"https://vuejs.org",target:"_blank"}},[t._v("Core Docs")])]),n("li",[n("a",{attrs:{href:"https://forum.vuejs.org",target:"_blank"}},[t._v("Forum")])]),n("li",[n("a",{attrs:{href:"https://chat.vuejs.org",target:"_blank"}},[t._v("Community Chat")])]),n("li",[n("a",{attrs:{href:"https://twitter.com/vuejs",target:"_blank"}},[t._v("Twitter")])])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("ul",[n("li",[n("a",{attrs:{href:"https://router.vuejs.org",target:"_blank"}},[t._v("vue-router")])]),n("li",[n("a",{attrs:{href:"https://vuex.vuejs.org",target:"_blank"}},[t._v("vuex")])]),n("li",[n("a",{attrs:{href:"https://github.com/vuejs/vue-devtools#vue-devtools",target:"_blank"}},[t._v("vue-devtools")])]),n("li",[n("a",{attrs:{href:"https://vue-loader.vuejs.org",target:"_blank"}},[t._v("vue-loader")])]),n("li",[n("a",{attrs:{href:"https://github.com/vuejs/awesome-vue",target:"_blank"}},[t._v("awesome-vue")])])])}],c={name:"HelloWorld",props:{msg:String}},u=c,l=(n("3f5d"),n("2877")),_=Object(l["a"])(u,i,o,!1,null,"d6bec2f6",null),d=(_.exports,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("vue-ins-progress-bar"),n("Login",{ref:"onShow",on:{afterLogin:t.after_login_success}}),t.show_trade?n("div",{staticClass:"mask"},[n("div",{staticClass:"add_trade"},[n("div",{staticClass:"row header"},[n("div",[n("div",{staticClass:"col-lg-5 title left"},[t._v(t._s(t.on_click_stock.name))]),n("div",{staticClass:"col-lg-5"},[n("button",{on:{click:function(e){t.show_trade_form=!t.show_trade_form}}},[t._v("+添加交易")])]),n("div",{staticClass:"col-lg-2 right",on:{click:t.close_trade_mask}},[n("i",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}})])]),t.show_trade_form?n("div",[n("div",{staticClass:"input-control"},[n("select",{directives:[{name:"model",rawName:"v-model",value:t.current_trade.account_id,expression:"current_trade.account_id"}],on:{change:function(e){var n=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){var e="_value"in t?t._value:t.value;return e});t.$set(t.current_trade,"account_id",e.target.multiple?n:n[0])}}},t._l(t.account_list,function(e,r){return n("option",{key:r,domProps:{value:e.id}},[t._v(t._s(e.name))])}))]),n("div",{staticClass:"input-control"},[n("select",{directives:[{name:"model",rawName:"v-model",value:t.current_trade.account_belong_id,expression:"current_trade.account_belong_id"}],on:{change:function(e){var n=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){var e="_value"in t?t._value:t.value;return e});t.$set(t.current_trade,"account_belong_id",e.target.multiple?n:n[0])}}},t._l(t.account_belong_list,function(e,r){return n("option",{key:r,domProps:{value:e.id}},[t._v(t._s(e.name))])}))]),n("div",{staticClass:"input-control"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.current_trade.shares,expression:"current_trade.shares"}],attrs:{type:"text",placeholder:"股数"},domProps:{value:t.current_trade.shares},on:{input:function(e){e.target.composing||t.$set(t.current_trade,"shares",e.target.value)}}})]),n("div",{staticClass:"input-control"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.current_trade.cost,expression:"current_trade.cost"}],attrs:{type:"text",placeholder:"成本"},domProps:{value:t.current_trade.cost},on:{input:function(e){e.target.composing||t.$set(t.current_trade,"cost",e.target.value)}}})]),n("div",{staticClass:"input-control"},[n("button",{attrs:{type:"submit"},on:{click:function(e){t.cou_trade(e)}}},[t._v("确定")]),n("button",{attrs:{type:"button"},on:{click:function(e){t.cancel_input_trade()}}},[t._v("取消")])])]):t._e()]),n("div",{staticStyle:{height:"300px",width:"100%",overflow:"scroll"}},[n("table",[t._m(0),n("tbody",t._l(t.trade_list,function(e,r){return n("tr",{key:r},[n("td",[t._v(t._s(r+1))]),n("td",[t._v(t._s(e.$account.name))]),n("td",[t._v(t._s(e.$account_belong.name))]),n("td",[t._v(t._s(e.shares))]),n("td",[t._v(t._s(e.cost))]),n("td",[n("span",[n("button",{on:{click:function(n){t.update_trade(e)}}},[t._v("更新")])]),n("span",[n("button",{on:{click:function(n){t.remove_trade(e.id,t.on_click_stock.code)}}},[t._v("删除")])])])])}))])])])]):t._e(),n("div",{staticClass:"container"},[n("div",[n("div",{staticClass:" search-bar"},[n("div",{staticClass:"col-lg-8"},[n("form",{on:{submit:function(e){t.cou_stock(e)}}},[n("div",{staticClass:"input-control"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.current_stock.code,expression:"current_stock.code"}],attrs:{type:"text",placeholder:"股票代码"},domProps:{value:t.current_stock.code},on:{input:function(e){e.target.composing||t.$set(t.current_stock,"code",e.target.value)}}})]),n("div",{staticClass:"input-control"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.current_stock.name,expression:"current_stock.name"}],attrs:{type:"text",placeholder:"股票名称"},domProps:{value:t.current_stock.name},on:{input:function(e){e.target.composing||t.$set(t.current_stock,"name",e.target.value)}}})]),t._m(1)])]),n("div",{staticClass:"col-lg-4 right log"},[t.username?n("div",[n("span",{staticClass:"username"},[t._v(t._s(t.username))]),n("span",{staticClass:"logout",on:{click:t.logout}},[t._v("退出")])]):n("button",{on:{click:t.toggle_login}},[t._v("登录")])])]),n("div",{staticClass:"banner"},[n("div",{staticClass:"col-lg-3"},[t._v("持有市值："+t._s(t.total_value))]),n("div",{staticClass:"col-lg-3"},[t._v("总盈亏："+t._s(t.math_round(t.total_value-t.total_cost_value)))]),n("div",{staticClass:"col-lg-6 right"},[n("button",{attrs:{type:"button"},on:{click:function(e){t.update_real()}}},[n("i",{staticClass:"fas fa-sync-alt"})])])]),n("table",[t._m(2),n("tbody",t._l(t.stock_list,function(e,r){return n("tr",{key:r,attrs:{id:"stock-list"}},[n("td",[t._v(t._s(e.name))]),n("td",[t._v(t._s(e.code))]),n("td",[t._v(t._s(999999==e.code?parseInt(1):e.price))]),n("td",[t._v(t._s(e.pct_chg&&t.addPercentCode(t.math_round_after_multi(e.pct_chg,1))||"-"))]),n("td",[t._v(t._s(e.pre_close||"-"))]),n("td",[t._v(t._s(e.cost||"-"))]),n("td",[t._v(t._s(e.shares||"-"))]),n("td",[t._v(t._s(t.math_round_after_multi(e.cost,e.shares)||t.math_round_after_multi(1,e.shares)))]),n("td",[t._v(t._s(t.math_round_after_multi(e.price,e.shares)||t.math_round_after_multi(1,e.shares)))]),n("td",[t._v(t._s(t.total_value&&t.toPercent(t.math_round_after_multi(e.price,e.shares)/t.total_value)||"-"))]),n("td",[t._v(t._s(t.math_round(t.math_round_after_multi(e.price,e.shares)-t.math_round_after_multi(e.cost,e.shares))||"-"))]),n("td",[n("div",{on:{click:function(n){t.on_show_trade(e.name,e.code,r)}}},[n("i",{staticClass:"fa fa-calculator",attrs:{"aria-hidden":"true"}})])]),n("td",[n("div",{on:{click:function(n){t.remove_stock(e.id)}}},[n("i",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}})])]),t._m(3,!0)])}))])])])],1)}),v=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("thead",[n("tr",[n("th",[t._v("序号")]),n("th",[t._v("账户")]),n("th",[t._v("姓名")]),n("th",[t._v("股数")]),n("th",[t._v("成本")]),n("th",[t._v("操作")])])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"input-control"},[n("button",{attrs:{type:"submit"}},[t._v("添加")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("thead",{staticClass:"thead"},[n("tr",[n("th",[t._v("全部股票")]),n("th",[t._v("股票代码")]),n("th",[t._v("最新价格")]),n("th",[t._v("涨跌幅")]),n("th",[t._v("昨收")]),n("th",[t._v("成本")]),n("th",[t._v("股数")]),n("th",[t._v("成本市值")]),n("th",[t._v("持有市值")]),n("th",[t._v("持仓比例")]),n("th",[t._v("盈亏")]),n("th",[t._v("账户")]),n("th",[t._v("删除")]),n("th",[t._v("操作")])])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("td",[n("div",[n("i",{staticClass:"fa fa-bars",attrs:{"aria-hidden":"true"}})])])}],h=(n("7f7f"),n("bc3a")),f=n.n(h),p="af9f36c4e5c171d1c2d7b5076030d238ca23a82bab5ab3aa59197401aa1504c6",m="https://mock.biaoyansu.com/api/1/",g="http://119.29.72.177:8888/todo/api/v1.0/tasks";function b(t,e){return btoa(t+e)}function k(t,e){var n=(new Date).getTime(),r=b(p,n),s={headers:{"BIAO-MOCK-APP-KEY":p,"BIAO-MOCK-TIMESTAMP":n,"BIAO-MOCK-SIGNATURE":r}};return t=m+t,f.a.post(t,e,s).then(function(t){return t.data})}function w(t){var e={headers:{"Content-Type":"application/json;charset=UTF-8"}};return f.a.post(g,t,e).then(function(t){return t.data})}var C={post:k,api:w},y=C,$=n("f499"),x=n.n($),E=(n("c5f6"),n("59ad")),P=n.n(E),N={sum_arr_by_prop:A,sum_arr_by_props:j,avg_arr:O,math_round:S,toPercent:I,set:T,get:q,remove_ls:L,add_percent_code:D};function A(t,e){if(t)return t.reduce(function(t,n){return null==n[e]?t:P()(t)+P()(n[e])},0)}function j(t,e,n){if(t)return t.reduce(function(t,r){return t+r[e]*r[n]},0)}function S(t){return Math.round(1e3*t)/1e3}function O(t,e){var n=A(t,e),r=t.length;return n/r}function I(t){var e=Number(100*t).toFixed(2);return e+="%",e}function T(t,e){var n=x()(e);localStorage.setItem(t,n)}function q(t){var e=localStorage.getItem(t);return JSON.parse(e)}function L(t){localStorage.removeItem(t)}function D(t){return t+"%"}var M=N,z=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.show_login?n("div",{staticClass:"mask"},[n("div",{class:"login-wrap "+("signup"==t.auth_by?"signup":"")},[n("div",{staticClass:"banner"},[n("div",{staticClass:"close",on:{click:t.toggle_login}},[n("i",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}})])]),n("div",{staticClass:"main"},[n("div",{staticClass:"header"},[n("span",{class:"col-lg-6 "+("login"==t.auth_by?"active":""),on:{click:function(e){t.auth_by="login"}}},[t._v("登录")]),n("span",{class:"col-lg-6 "+("signup"==t.auth_by?"active":""),on:{click:function(e){t.auth_by="signup"}}},[t._v("注册")])]),"login"==t.auth_by?n("form",{key:"login",on:{submit:function(e){t.submit(e)}}},[n("div",{staticClass:"input-control"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.current.name,expression:"current.name"},{name:"validatorLogin",rawName:"v-validatorLogin",value:"required",expression:"'required'"}],attrs:{type:"text",placeholder:"用户名","error-el":"#username_error",autocomplete:"off"},domProps:{value:t.current.name},on:{input:function(e){e.target.composing||t.$set(t.current,"name",e.target.value)}}}),t._m(0)]),n("div",{staticClass:"input-control"},[n("input",{directives:[{name:"validatorLogin",rawName:"v-validatorLogin",value:"required|min_length:2|max_length:6",expression:"'required|min_length:2|max_length:6'"},{name:"model",rawName:"v-model",value:t.current.password,expression:"current.password"}],attrs:{id:"password",type:"password",placeholder:"密码","error-el":"#password-error"},domProps:{value:t.current.password},on:{input:function(e){e.target.composing||t.$set(t.current,"password",e.target.value)}}}),t._m(1)]),t._m(2)]):t._e(),"signup"==t.auth_by?n("form",{key:"signup",on:{submit:function(e){t.submit(e)}}},[n("div",{staticClass:"input-control"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.current.name,expression:"current.name"},{name:"validatorSignup",rawName:"v-validatorSignup",value:"required|not_exist:user,name",expression:"'required|not_exist:user,name'"}],attrs:{type:"text",placeholder:"用户名","error-el":"#username_error",autocomplete:"off"},domProps:{value:t.current.name},on:{input:function(e){e.target.composing||t.$set(t.current,"name",e.target.value)}}}),t._m(3)]),n("div",{staticClass:"input-control"},[n("input",{directives:[{name:"validatorSignup",rawName:"v-validatorSignup",value:"required|min_length:2|max_length:6",expression:"'required|min_length:2|max_length:6'"},{name:"model",rawName:"v-model",value:t.current.password,expression:"current.password"}],attrs:{id:"password",type:"password",placeholder:"密码","error-el":"#password-error"},domProps:{value:t.current.password},on:{input:function(e){e.target.composing||t.$set(t.current,"password",e.target.value)}}}),t._m(4)]),n("div",{staticClass:"input-control"},[n("input",{directives:[{name:"validatorSignup",rawName:"v-validatorSignup",value:"required|shadow:#password",expression:"'required|shadow:#password'"},{name:"model",rawName:"v-model",value:t.current.repassword,expression:"current.repassword"}],attrs:{id:"repassword",type:"password",placeholder:"重复密码","error-el":"#repassword-error"},domProps:{value:t.current.repassword},on:{input:function(e){e.target.composing||t.$set(t.current,"repassword",e.target.value)}}}),t._m(5)]),n("div",{staticClass:"input-control"},[n("input",{directives:[{name:"validatorSignup",rawName:"v-validatorSignup",value:"required|mail",expression:"'required|mail'"},{name:"model",rawName:"v-model",value:t.current.mail,expression:"current.mail"}],attrs:{id:"mail",type:"text",placeholder:"邮箱","error-el":"#mail-error"},domProps:{value:t.current.mail},on:{input:function(e){e.target.composing||t.$set(t.current,"mail",e.target.value)}}}),t._m(6)]),t._m(7)]):t._e()])])]):t._e()},K=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"error-list"},[n("div",{attrs:{id:"username_error"}})])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"error-list"},[n("div",{attrs:{id:"password-error"}})])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"input-control"},[n("button",{attrs:{type:"submit"}},[n("span",[t._v("登录")])])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"error-list"},[n("div",{attrs:{id:"username_error"}})])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"error-list"},[n("div",{attrs:{id:"password-error"}})])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"error-list"},[n("div",{attrs:{id:"repassword-error"}})])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"error-list"},[n("div",{attrs:{id:"mail-error"}})])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"input-control"},[n("button",{attrs:{type:"submit"}},[n("span",[t._v("注册")])])])}],W=n("75fc"),F=n("e814"),Z=n.n(F),B=n("bd86"),H=n("795b"),J=n.n(H);n("6b54"),n("28a5"),n("ac6a");function U(t){var e={};return t.split("|").forEach(function(t){var n=t.split(":"),r=n[0],s=n[1];s&&(s=s.split(",")),s=void 0===s||s,e[r]=s}),e}var G={max:function(t,e,n){var r={zh:"最大值为："+n,en:"Max value: "+n};if(this.numeric(t)&&P()(t)>n)throw r[e];return!0},positive:function(t,e){var n={zh:"不合法的数字",en:"Invalid number"};if(this.numeric(t)&&P()(t)<0)throw n[e];return!0},mail:function(t,e){var n={zh:"不合法的邮箱",en:"Invalid email"},r=/[a-zA-Z0-9]+@[a-zA-Z0-9]+\.[a-zA-Z]+/;if(!r.test(t))throw n[e];return!0},numeric:function(t,e){var n={zh:"不合法的数字",en:"Invalid number"};if(P()(t)!=t)throw n[e];return!0},cellphone:function(t,e){var n={zh:"不合法的手机号",en:"Invalid phone number"};if(!this.numeric(t,e)||!this.length(t,e,11))throw n[e];return!0},length:function(t,e,n){var r={zh:"不合法的长度，长度需等于"+n+"位",en:"Invalid field length, length should equals to "+n};if(t=t.toString(),t.length==n)return!0;throw r[e]},username:function(t,e){var n={zh:"用户名不合法，只能包含字母和数字",en:"Invalid username"},r=/^[a-zA-Z0-9]*$/,s=r.test(t);if(!s)throw n[e];return s},shadow:function(t,e,n){var r={zh:"两次输入不一致",en:"Inconsistent double inputs"},s=document.querySelector(n),a=s.value;if(a!==t)throw r[e];return!0},not_exist:function(t,e,n,r,s){return new J.a(function(e,a){return t&&t!=s||e(),y.post("".concat(n,"/first"),{where:{and:Object(B["a"])({},r,t)}}).then(function(t){return t.data?a("用户名已存在"):e(!0)})})},required:function(t,e){var n={zh:"此项为必填项",en:"This field is required"};if("number"===typeof t)return!0;var r=!!t;if(!r)throw n[e];return r},min_length:function(t,e,n){var r={zh:"此项的最小长度为"+n,en:"Minimal length: "+n},s=t.length>=Z()(n);if(!s)throw r[e];return s},max_length:function(t,e,n){var r={zh:"此项的最大长度为"+n,en:"Maximum length: "+n},s=t.length<=Z()(n);if(!s)throw r[e];return s}};function R(t,e){var n=!1;t.forEach(function(t){"true"===t.getAttribute("invalid")&&(n=!0)}),n?Y(e):Q(e)}function Y(t){t.setAttribute("disabled","disabled")}function Q(t){t.removeAttribute("disabled")}function V(t,e){var n=t.querySelector("[type=submit]");if(!n)throw"Missing submit button.";t.$state={lang:e,el_submit:n,input_list:[]}}function X(t,e){t.$state.input_list.push(e)}function tt(t,e,n,r){var s=e.value,a=!1,i=t.$state.lang,o="";if(v(!1),s||r.required){if(r.required)try{G.required(s,i)}catch(h){return void v(!0,h)}for(var c in r){var u=r[c],l=G[c].bind(G);try{var _=[s,t.$state.lang].concat(u);if(!a){var d=l.apply(void 0,Object(W["a"])(_));d instanceof J.a&&d.then(function(t){t&&v(!1)}).catch(function(t){v(!0,t)})}}catch(h){v(!0,h);break}}}function v(r,s){r?(o+='<div class="error">'.concat(s,"</div>"),e.setAttribute("invalid","true")):e.setAttribute("invalid","false"),"true"===e.getAttribute("dirty")&&(n.innerHTML=o),R(t.$state.input_list,t.$state.el_submit)}}var et,nt,rt=r["a"].directive("validator-login",{inserted:function(t,e){var n,r=e.value,s=t.getAttribute("error-el"),a=document.querySelector(s);a||(a=document.createElement("div"),a.classList.add("error-list"),t.insertAdjacentElement("afterEnd",a)),"string"===typeof r&&(r=U(e.value));var i=t.closest("form");if(!i.$state){var o=t.getAttribute("error-lang")||"zh";V(i,o)}function c(){clearTimeout(n),n=setTimeout(function(){tt(i,t,a,r)},300)}X(i,t),tt(i,t,a,r),t.addEventListener("keyup",c),t.addEventListener("change",c),t.addEventListener("focus",function(){t.setAttribute("dirty","true")})}}),st={directives:{validatorLogin:rt,validatorSignup:rt},data:function(){return{auth_by:"login",current:{},user_id:"",show_login:!1}},methods:{toggle_login:function(){this.show_login=!this.show_login,this.current={}},submit:function(t){var e=this;t.preventDefault(),"login"==this.auth_by?y.post("user/search",{where:{and:{name:this.current.name}}}).then(function(t){var n=t.data;n&&delete n[0].password,M.set("uinfo",n),e.show_login=!1,e.$emit("afterLogin",n)}):"signup"==this.auth_by&&y.post("user/create",this.current).then(function(t){var n=t;e.show_login=!1,e.$router.push("/"),e.$emit("afterLogin",n)})}}},at=st,it=(n("a614"),Object(l["a"])(at,z,K,!1,null,"367af2ac",null)),ot=it.exports,ct=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"nav-global",style:{marginBottom:this.pushDown?"20px":0}},[n("div",{staticClass:"row container"},[n("router-link",{staticClass:"col-lg-1",attrs:{to:"/"}},[n("a",{attrs:{href:"#"}})]),n("div",{staticClass:"col-lg-3 left"},[n("router-link",{staticClass:"nav-item",attrs:{to:"/"}},[t._v("首页")])],1),n("div",{staticClass:"col-lg-4"}),n("div",{staticClass:"col-lg-4 right"},[n("router-link",{staticClass:"nav-item",attrs:{to:"/login"}},[t._v("登录")]),n("router-link",{staticClass:"nav-item",attrs:{to:"/signup",href:"#"}},[t._v("注册")])],1)],1)])},ut=[],lt={props:{pushDown:{default:!1}}},_t=lt,dt=(n("1d0a"),Object(l["a"])(_t,ct,ut,!1,null,"3c0669b2",null)),vt=dt.exports,ht={components:{Login:ot,Nav:vt},data:function(){return{show_trade_form:!1,show_trade:!1,on_click_stock:{},current_trade:{},current_stock:{},trade_list:[],account_list:[],account_belong_list:[],stock_list:[],stock_code_list:[],real:[],username:"",user_id:""}},methods:{update_real:function(){var t=this;this.$insProgress.start(),this.get_code_list();var e=this.stock_code_list.indexOf("999999");console.log("index",e);var n=this.stock_code_list;-1!=e&&n.splice(e,1),y.api(n).then(function(e){t.real=e,t.$insProgress.finish()})},after_login_success:function(t){this.username=t[0].name,this.user_id=t[0].id,this.init_stock()},logout:function(){M.remove_ls("uinfo"),this.username=""},toggle_login:function(){var t=this;this.$nextTick(function(){t.$refs.onShow.toggle_login()})},math_round_after_multi:function(t,e){return M.math_round(t*e)},math_round:function(t){return M.math_round(t)},toPercent:function(t){return M.toPercent(t)},addPercentCode:function(t){return M.add_percent_code(t)},close_trade_mask:function(){this.show_trade=!1},cancel_input_trade:function(){this.show_trade_form=!1,console.log("cancel_input"),this.current_trade={}},on_show_trade:function(t,e,n){this.show_trade=!0,this.on_click_stock.name=t,this.on_click_stock.code=e,this.on_click_stock.index=n,this.read_trade(e)},update_cal_stock:function(t,e){this.stock_list[t].shares=M.math_round(M.sum_arr_by_prop(e,"shares")),this.stock_list[t].cost=M.math_round(M.sum_arr_by_props(e,"cost","shares")/this.stock_list[t].shares)},cou_trade:function(t){var e=this;if(t.preventDefault(),this.current_trade.account_id){this.current_trade.stock_code=this.on_click_stock.code,this.current_trade.stock_name=this.on_click_stock.name,this.current_trade.user_id=this.user_id;var n=this.current_trade.id?"update":"create";y.post("trade/".concat(n),this.current_trade).then(function(t){e.read_trade(e.on_click_stock.code,e.on_click_stock.index,e.update_cal_stock),e.current_trade={}})}},cou_stock:function(t){var e=this;if(t.preventDefault(),this.current_stock.code){this.current_stock.user_id=this.user_id;var n=this.current_stock.id?"update":"create";y.post("stock/".concat(n),this.current_stock).then(function(t){e.current_stock={},e.init_stock()})}},remove_trade:function(t,e){var n=this;confirm("确定需要删除吗？")&&y.post("trade/delete",{id:t}).then(function(t){n.read_trade(e,n.on_click_stock.index,n.update_cal_stock)})},remove_stock:function(t){var e=this;confirm("确定需要删除吗？")&&y.post("stock/delete",{id:t}).then(function(t){e.read_stock()})},update_trade:function(t){this.current_trade=t,this.show_trade_form=!0},read_stock:function(t){var e=this;y.post("stock/read",{where:{user_id:this.user_id},limit:50}).then(function(n){e.stock_list=n.data,console.log("this.stock_list",e.stock_list),t&&t()})},read_account:function(){var t=this;y.post("account/read").then(function(e){t.account_list=e.data})},read_account_belong:function(){var t=this;y.post("account_belong/read",{where:{user_id:this.user_id}}).then(function(e){t.account_belong_list=e.data})},read_trade:function(t,e,n){var r=this;y.post("trade/search",{and:{stock_code:t,user_id:this.user_id},with:[{model:"account",relation:"has_one"},{model:"account_belong",relation:"has_one"},{model:"user",relation:"has_one"}]}).then(function(t){r.trade_list=t.data,n&&n(e,r.trade_list)})},init_stock:function(){this.is_login(),this.user_id?this.read_stock(this.cal_stock_data):this.toggle_login()},cal_stock_data:function(){for(var t=this.stock_list,e=0;e<t.length;e++){var n=t[e].code;this.read_trade(n,e,this.update_cal_stock)}},meger_real_to_stock:function(){for(var t,e=this.real,n=e.length,r=this.stock_list,s=r.length,a=0;a<n;a++)for(var i=0;i<s;i++)e[a].ts_code.substring(0,6)==r[i].code&&(this.$set(r[i],"price",e[a].close),this.$set(r[i],"pct_chg",e[a].pct_chg),this.$set(r[i],"pre_close",e[a].pre_close));for(var o=0;o<s;o++)"999999"==r[o].code&&(t=o);this.$set(r[t],"price",1),this.$set(r[t],"pre_close",1),console.log("this.stock_list",this.stock_list)},is_login:function(){var t=M.get("uinfo");t&&(this.username=t[0].name,console.log("this.username",this.username),this.user_id=t[0].id,console.log("this.user_id",this.user_id))},get_code_list:function(){for(var t=this.stock_list,e=t.length,n=this.stock_code_list=[],r=0;r<e;r++){var s=t[r].code;n.push(s)}}},computed:{total_value:function(){var t=M.sum_arr_by_props(this.stock_list,"price","shares");return M.math_round(t)},total_cost_value:function(){var t=M.sum_arr_by_props(this.stock_list,"cost","shares");return M.math_round(t)}},mounted:function(){this.init_stock(),this.read_account(),this.read_account_belong()},watch:{real:{deep:!0,handler:function(t){this.meger_real_to_stock()}}}},ft=ht,pt=(n("6cb5"),Object(l["a"])(ft,d,v,!1,null,"0f8e5470",null)),mt=pt.exports,gt={name:"app",components:{Home:mt,Login:ot}},bt=gt,kt=(n("034f"),Object(l["a"])(bt,s,a,!1,null,null,null)),wt=kt.exports,Ct=n("8c4f"),yt=(n("7051"),n("c4f2"),n("708f"),n("fc86")),$t=n.n(yt),xt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("router-view")],1)},Et=[],Pt={},Nt=Pt,At=Object(l["a"])(Nt,xt,Et,!1,null,null,null),jt=At.exports,St=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("Nav",{attrs:{pushDown:!0}}),n("div",[n("div",{staticClass:"container"},[n("div",{staticClass:"col-lg-3"},[n("AdminNav")],1),n("div",{staticClass:"col-lg-9 wrapper"},[n("h2",[t._v("股票管理")]),n("div",{staticClass:"tool-bar"},[n("button",{on:{click:function(e){t.show_form=!t.show_form}}},[t.show_form?n("span",[t._v("收起")]):n("span",[t._v("创建股票")])])]),t.show_form?n("form",{on:{submit:function(e){t.cou(e)}}},[n("div",{staticClass:"input-control"},[n("label",[t._v("用户id")]),n("input",{directives:[{name:"model",rawName:"v-model",value:t.current.user_id,expression:"current.user_id"}],attrs:{type:"text"},domProps:{value:t.current.user_id},on:{input:function(e){e.target.composing||t.$set(t.current,"user_id",e.target.value)}}})]),n("div",{staticClass:"input-control"},[n("label",[t._v("股票名称")]),n("input",{directives:[{name:"model",rawName:"v-model",value:t.current.name,expression:"current.name"}],attrs:{type:"text"},domProps:{value:t.current.name},on:{input:function(e){e.target.composing||t.$set(t.current,"name",e.target.value)}}})]),n("div",{staticClass:"input-control"},[n("label",[t._v("股票代码")]),n("input",{directives:[{name:"model",rawName:"v-model",value:t.current.code,expression:"current.code"}],attrs:{type:"text"},domProps:{value:t.current.code},on:{input:function(e){e.target.composing||t.$set(t.current,"code",e.target.value)}}})]),n("div",{staticClass:"input-control"},[n("button",{staticClass:"btn-primary",attrs:{type:"submit"}},[t._v("提交")]),n("button",{staticClass:"btn-primary",attrs:{type:"button"},on:{click:function(e){t.cancel()}}},[t._v("取消")])])]):t._e(),n("div",{staticClass:"table"},[n("table",[t._m(0),n("tbody",t._l(t.list,function(e,r){return n("tr",{key:r},[n("td",[t._v(t._s(e.id))]),n("td",[t._v(t._s(e.code))]),n("td",[t._v(t._s(e.name))]),n("td",[t._v(t._s(e.$user.name))]),n("td",[n("button",{on:{click:function(n){t.update(e)}}},[t._v("编辑")]),n("button",{on:{click:function(n){t.remove(e.id)}}},[t._v("删除")])])])}))])])]),n("pagination",{attrs:{limit:t.limit,totalCount:t.total,onChange:t.on_page_change}})],1)])],1)},Ot=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("thead",[n("th",[t._v("id")]),n("th",[t._v("股票代码")]),n("th",[t._v("股票名称")]),n("th",[t._v("用户")]),n("th",[t._v("操作")])])}],It=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"nav-side",style:{width:t.width}},[n("router-link",{staticClass:"nav-item",attrs:{to:"/admin/user"}},[t._v("用户管理")]),n("router-link",{staticClass:"nav-item",attrs:{to:"/admin/stock"}},[t._v("股票管理")]),n("router-link",{staticClass:"nav-item",attrs:{to:"/admin/trade"}},[t._v("交易管理")]),n("router-link",{staticClass:"nav-item",attrs:{to:"/admin/account"}},[t._v("股票账户管理")])],1)},Tt=[],qt=(n("f58b"),{props:{width:["width"]}}),Lt=qt,Dt=(n("f226"),Object(l["a"])(Lt,It,Tt,!1,null,"91062fcc",null)),Mt=Dt.exports,zt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"row dropdown",style:{width:t.Width+"px"},on:{mouseleave:function(e){t.show_menu=!1}}},[t.showInput?n("input",{directives:[{name:"model",rawName:"v-model",value:t.keyword,expression:"keyword"}],attrs:{type:"search",placeholder:"请搜索"},domProps:{value:t.keyword},on:{keyup:function(e){t.show_menu=!0},focus:function(e){t.show_menu=!0},input:function(e){e.target.composing||(t.keyword=e.target.value)}}}):t._e(),n("div",{staticClass:"drop-area",on:{mouseenter:function(e){t.show_menu=!0}}},[t.showItemTitle?n("div",{staticClass:"drop-title"},[t._v(t._s(t.selected?t.selected[t.displayKey]:t.itemTitle?t.itemTitle:"请选择"))]):t._e(),t.result.length&&t.show_menu?n("div",{staticClass:"drop-item"},t._l(t.result,function(e,r){return n("div",{key:r,on:{click:function(n){t.select(e)}}},[t._v(t._s(e[t.displayKey]))])})):t._e()])])},Kt=[],Wt=(n("386d"),n("7514"),n("5176")),Ft=n.n(Wt),Zt={props:{Width:"",showItemTitle:{default:!1},itemTitle:{},showInput:{default:!1},api:{},list:{default:function(){return[]}},default:{},onSelect:{},primaryKey:{default:"id"},displayKey:{default:"name"}},data:function(){return{api_conf:{},result:[],selected:"",show_menu:!1,keyword:"",timer:null}},methods:{test:function(){console.log("11")},parse_api:function(){var t=this.api;if("string"!=typeof t)return Ft()({},api);t=t.split(".");var e=t[0],n=t[1];return n=n.split(","),{model:e,property:n}},on_edit_model:function(t){t||(this.selected={}),this.selected=t},on_edit_vehicle:function(t){t||(this.selected={}),this.selected=t},on_edit_report:function(t){t||(this.selected={}),this.selected=t},set_default:function(){var t=this,e=this.default;if(e){var n=this.list.find(function(n){return n[t.primaryKey]==e});this.select(n)}},select:function(t){this.selected=t,this.showInput&&(this.keyword=t[this.displayKey]),this.onSelect&&this.onSelect(t)},filter:function(){var t=this;this.result=Ft()([],this.list),this.result=this.result.filter(function(e){return-1!==e[t.displayKey].indexOf(t.keyword)})},search:function(){var t=this,e={},n=this.api_conf.property;n&&(n.forEach(function(n){e[n]=t.keyword}),clearTimeout(this.timer),this.timer=setTimeout(function(){api("".concat(t.api_conf.model,"/search"),{or:e}).then(function(e){t.result=e.data})},300))}},mounted:function(){this.api_conf=this.parse_api();var t=this.list;t&&(this.result=this.list),console.log("this.result",this.result)},watch:{keyword:function(){this.api?this.search():this.filter()},default:{deep:!0,handler:function(){this.set_default()}},list:function(t){this.list=t,this.result=this.list,console.log("this.result111",this.result)},change_item_title:function(){return itemTitle?selected?selected[displayKey]:"请选择":itemTitle}}},Bt=Zt,Ht=(n("be01"),Object(l["a"])(Bt,zt,Kt,!1,null,null,null)),Jt=Ht.exports,Ut=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"pagination"},[n("span",{staticClass:"btn-group"},[n("button",{staticClass:"btn-small",attrs:{disabled:t.is_first_page},on:{click:function(e){t.change(1)}}},[t._v("First\n  ")]),n("button",{staticClass:"btn-small",attrs:{disabled:t.is_first_page},on:{click:function(e){t.prev()}}},[t._v("Prev\n  ")])]),t._v("\n\n \n\n"),n("span",{staticClass:"btn-group"},t._l(t.last_page,function(e){return Math.abs(e-t.current_page)<=t.half_limit?n("button",{key:e,staticClass:"btn-small",class:{active:t.current_page==e},on:{click:function(n){t.change(e)}}},[t._v(t._s(e)+"\n                    \n            ")]):t._e()})),t._v("\n \n\n"),n("span",{staticClass:"btn-group"},[n("button",{staticClass:"btn-small",attrs:{disabled:t.is_last_page},on:{click:function(e){t.next()}}},[t._v("Next\n  ")]),n("button",{staticClass:"btn-small",attrs:{disabled:t.is_last_page},on:{click:function(e){t.change(t.last_page)}}},[t._v("Last\n  ")])])])},Gt=[],Rt={props:{limit:{default:0},totalCount:{default:0},onChange:{default:function(){console.log(1)}},currentPage:{default:1}},data:function(){return{current_page:1}},methods:{change:function(t){this.onChange&&this.onChange(t),this.current_page=t},prev:function(){this.is_first_page||this.change(--this.current_page)},next:function(){this.is_last_page||this.change(++this.current_page)}},computed:{half_limit:function(){return Math.floor(this.limit/2)},is_first_page:function(){return 1==this.current_page},is_last_page:function(){return this.current_page==this.last_page},last_page:function(){return Math.ceil(this.totalCount/this.limit)}},watch:{currentPage:function(t){this.current_page=t}}},Yt=Rt,Qt=(n("7456"),Object(l["a"])(Yt,Ut,Gt,!1,null,"57f3a386",null)),Vt=Qt.exports,Xt={components:{Nav:vt,AdminNav:Mt,DropDown:Jt,Pagination:Vt},data:function(){return{total:0,last_page:0,current_page:1,limit:5,show_form:!1,current:{preview:[]},list:[],edit_mode:!1,keyword:"",model:null}},methods:{on_page_change:function(t){this.read(t)},read:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;y.post("".concat(this.model,"/read"),{limit:this.limit,page:e,sort_by:["id","down"],with:this.with}).then(function(e){t.list=e.data,console.log("this.list",t.list),t.total=e.total,t.last_page=e.last_page,t.current_page=e.current_page})},cou:function(t){var e=this;t.preventDefault();var n=this.current.id?"update":"create";y.post("".concat(this.model,"/").concat(n),this.current).then(function(t){e.read(e.current_page)})},remove:function(t){var e=this;y.post("".concat(this.model,"/delete"),{id:t}).then(function(t){e.read()})},update:function(t){this.current=t,this.show_form=!0},edit_model:function(t){this.$refs.edit_brand.on_edit_model(t.$brand),this.$refs.edit_design.on_edit_model(t.$design)},edit_vehicle:function(t){this.$refs.edit_vehicle_brand.on_edit_vehicle(t.$brand),this.$refs.edit_vehicle_model.on_edit_vehicle(t.$model),this.$refs.edit_vehicle_design.on_edit_vehicle(t.$design)},edit_report:function(t){this.$refs.edit_report.on_edit_report(t.$vehicle)},cancel:function(){this.current={preview:[]},this.show_form=!1},search:function(t){var e=this,n={or:{}};this.searchable.forEach(function(e){n.or[e]=t}),y.post("".concat(this.model,"/search"),n).then(function(t){e.list=t.data,e.total=t.total})}},mounted:function(){if(!this.model)throw new Error("请在模型中配置model！");this.read()}},te=Xt,ee=Object(l["a"])(te,et,nt,!1,null,"0c79ccb4",null),ne=ee.exports,re={mixins:[ne],created:function(){this.model="stock"},data:function(){return{show_form:!1,with:[{model:"user",relation:"has_one"}]}}},se=re,ae=(n("dc27"),Object(l["a"])(se,St,Ot,!1,null,"afcb5db8",null)),ie=ae.exports,oe=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("Nav",{attrs:{pushDown:!0}}),n("div",[n("div",{staticClass:"container"},[n("div",{staticClass:"col-lg-3"},[n("AdminNav")],1),n("div",{staticClass:"col-lg-9 wrapper"},[n("h2",[t._v("交易管理")]),n("div",{staticClass:"tool-bar"},[n("button",{on:{click:function(e){t.show_form=!t.show_form}}},[t.show_form?n("span",[t._v("收起")]):n("span",[t._v("创建交易记录")])])]),t.show_form?n("form",{on:{submit:function(e){t.cou(e)}}},[n("div",{staticClass:"input-control"},[n("label",[t._v("用户id")]),n("DropDown",{attrs:{list:t.user_list,itemTitle:"请选择",onSelect:t.set_user_id}}),t._v(t._s(this.current.user_id)+"\n                            ")],1),n("div",{staticClass:"input-control"},[n("label",[t._v("股票代码")]),n("input",{directives:[{name:"model",rawName:"v-model",value:t.current.stock_name,expression:"current.stock_name"}],attrs:{type:"text"},domProps:{value:t.current.stock_name},on:{input:function(e){e.target.composing||t.$set(t.current,"stock_name",e.target.value)}}})]),n("div",{staticClass:"input-control"},[n("label",[t._v("股票名称")]),n("input",{directives:[{name:"model",rawName:"v-model",value:t.current.stock_code,expression:"current.stock_code"}],attrs:{type:"text"},domProps:{value:t.current.stock_code},on:{input:function(e){e.target.composing||t.$set(t.current,"stock_code",e.target.value)}}})]),n("div",{staticClass:"input-control"},[n("label",[t._v("成本")]),n("input",{directives:[{name:"model",rawName:"v-model",value:t.current.cost,expression:"current.cost"}],attrs:{type:"text"},domProps:{value:t.current.cost},on:{input:function(e){e.target.composing||t.$set(t.current,"cost",e.target.value)}}})]),n("div",{staticClass:"input-control"},[n("label",[t._v("股数")]),n("input",{directives:[{name:"model",rawName:"v-model",value:t.current.shares,expression:"current.shares"}],attrs:{type:"text"},domProps:{value:t.current.shares},on:{input:function(e){e.target.composing||t.$set(t.current,"shares",e.target.value)}}})]),n("div",{staticClass:"input-control"},[n("label",[t._v("股票账户")]),n("DropDown",{attrs:{list:t.account_list,itemTitle:"请选择账户",onSelect:t.set_account_id}}),t._v(t._s(this.current.account_id)+"\n                            ")],1),n("div",{staticClass:"input-control"},[n("label",[t._v("股票账户归属人")]),n("input",{directives:[{name:"model",rawName:"v-model",value:t.current.account_belong,expression:"current.account_belong"}],attrs:{type:"text"},domProps:{value:t.current.account_belong},on:{input:function(e){e.target.composing||t.$set(t.current,"account_belong",e.target.value)}}})]),n("div",{staticClass:"input-control"},[n("button",{staticClass:"btn-primary",attrs:{type:"submit"}},[t._v("提交")]),n("button",{staticClass:"btn-primary",attrs:{type:"button"},on:{click:function(e){t.cancel()}}},[t._v("取消")])])]):t._e(),n("div",{staticClass:"table"},[n("table",[t._m(0),n("tbody",t._l(t.list,function(e,r){return n("tr",{key:r},[n("td",[t._v(t._s(e.id))]),n("td",[t._v(t._s(e.$user?e.$user.name:"-"))]),n("td",[t._v(t._s(e.stock_code||"-"))]),n("td",[t._v(t._s(e.stock_name))]),n("td",[t._v(t._s(e.cost||"-"))]),n("td",[t._v(t._s(e.shares||"-"))]),n("td",[t._v(t._s(e.$account?e.$account.name:"-"))]),n("td",[t._v(t._s(e.account_belong||"-"))]),n("td",[n("button",{on:{click:function(n){t.update(e)}}},[t._v("编辑")]),n("button",{on:{click:function(n){t.remove(e.id)}}},[t._v("删除")])])])}))])])])])])],1)},ce=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("thead",[n("th",[t._v("id")]),n("th",[t._v("用户")]),n("th",[t._v("股票代码")]),n("th",[t._v("股票名称")]),n("th",[t._v("成本")]),n("th",[t._v("股数")]),n("th",[t._v("股票账户")]),n("th",[t._v("账户归属人")]),n("th",[t._v("操作")])])}],ue={mixins:[ne],created:function(){this.model="trade"},data:function(){return{show_form:!1,user_list:[],account_list:[],with:[{model:"account",relation:"has_one"},{model:"user",relation:"has_one"}]}},methods:{read_by:function(t){var e=this;y.post("".concat(t,"/read")).then(function(n){e[t+"_list"]=n.data})},set_user_id:function(t){this.$set(this.current,"user_id",t.id)},set_account_id:function(t){this.$set(this.current,"account_id",t.id)}},mounted:function(){this.read_by("user"),this.read_by("account")}},le=ue,_e=(n("da65"),Object(l["a"])(le,oe,ce,!1,null,"43eff14f",null)),de=_e.exports,ve=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("Nav",{attrs:{pushDown:!0}}),n("div",[n("div",{staticClass:"container"},[n("div",{staticClass:"col-lg-3"},[n("AdminNav")],1),n("div",{staticClass:"col-lg-9 wrapper"},[n("h2",[t._v("账户管理")]),n("div",{staticClass:"tool-bar"},[n("button",{on:{click:function(e){t.show_form=!t.show_form}}},[t.show_form?n("span",[t._v("收起")]):n("span",[t._v("创建账户")])])]),t.show_form?n("form",{on:{submit:function(e){t.cou(e)}}},[n("div",{staticClass:"input-control"},[n("label",[t._v("账户名称")]),n("input",{directives:[{name:"model",rawName:"v-model",value:t.current.name,expression:"current.name"}],attrs:{type:"text"},domProps:{value:t.current.name},on:{input:function(e){e.target.composing||t.$set(t.current,"name",e.target.value)}}})]),n("div",{staticClass:"input-control"},[n("button",{staticClass:"btn-primary",attrs:{type:"submit"}},[t._v("提交")]),n("button",{staticClass:"btn-primary",attrs:{type:"button"},on:{click:function(e){t.cancel()}}},[t._v("取消")])])]):t._e(),n("div",{staticClass:"table"},[n("table",[t._m(0),n("tbody",t._l(t.list,function(e,r){return n("tr",{key:r},[n("td",[t._v(t._s(e.id))]),n("td",[t._v(t._s(e.name))]),n("td",[n("button",{on:{click:function(n){t.update(e)}}},[t._v("编辑")]),n("button",{on:{click:function(n){t.remove(e.id)}}},[t._v("删除")])])])}))])])])])])],1)},he=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("thead",[n("th",[t._v("id")]),n("th",[t._v("账户名称")]),n("th",[t._v("操作")])])}],fe={mixins:[ne],created:function(){this.model="account"},data:function(){return{show_form:!1,with:[{model:"account",relation:"has_one"}]}}},pe=fe,me=(n("e04d"),Object(l["a"])(pe,ve,he,!1,null,"062267b2",null)),ge=me.exports,be=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("Nav",{attrs:{pushDown:!0}}),n("div",[n("div",{staticClass:"container"},[n("div",{staticClass:"col-lg-3"},[n("AdminNav")],1),n("div",{staticClass:"col-lg-9 wrapper"},[n("h2",[t._v("用户管理")]),n("div",{staticClass:"tool-bar"},[n("button",{on:{click:function(e){t.show_form=!t.show_form}}},[t.show_form?n("span",[t._v("收起")]):n("span",[t._v("创建用户")])])]),t.show_form?n("form",{on:{submit:function(e){t.cou(e)}}},[n("div",{staticClass:"input-control"},[n("label",[t._v("用户名称")]),n("input",{directives:[{name:"model",rawName:"v-model",value:t.current.name,expression:"current.name"}],attrs:{type:"text"},domProps:{value:t.current.name},on:{input:function(e){e.target.composing||t.$set(t.current,"name",e.target.value)}}})]),n("div",{staticClass:"input-control"},[n("button",{staticClass:"btn-primary",attrs:{type:"submit"}},[t._v("提交")]),n("button",{staticClass:"btn-primary",attrs:{type:"button"},on:{click:function(e){t.cancel()}}},[t._v("取消")])])]):t._e(),n("div",{staticClass:"table"},[n("table",[t._m(0),n("tbody",t._l(t.list,function(e,r){return n("tr",{key:r},[n("td",[t._v(t._s(e.id))]),n("td",[t._v(t._s(e.name))]),n("td",[t._v(t._s(e.password))]),n("td",[t._v(t._s(e.mail))]),n("td",[n("button",{on:{click:function(n){t.update(e)}}},[t._v("编辑")]),n("button",{on:{click:function(n){t.remove(e.id)}}},[t._v("删除")])])])}))])])])])])],1)},ke=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("thead",[n("th",[t._v("id")]),n("th",[t._v("用户名称")]),n("th",[t._v("密码")]),n("th",[t._v("邮箱")]),n("th",[t._v("操作")])])}],we={mixins:[ne],created:function(){this.model="user"},data:function(){return{show_form:!1,with:[{model:"account",relation:"has_one"}]}}},Ce=we,ye=(n("cc7f"),Object(l["a"])(Ce,be,ke,!1,null,"4ec5694a",null)),$e=ye.exports,xe=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("vue-ins-progress-bar"),n("div",[n("div",{staticClass:"container"},[n("div",{staticClass:"col-lg-3"},[n("StockAccountNav",{on:{getPerAccount:t.getPerAccount}})],1),n("div",{staticClass:"col-lg-9  card"},[n("div",{staticClass:"title"},[t._v("\n                    账户类别： \n                    "+t._s(t.perAccountInfo.$account?t.perAccountInfo.$account.name:"-")+"-"+t._s(t.perAccountInfo.name?t.perAccountInfo.name:"-")+"\n                ")]),n("div",{staticClass:"board"},[n("div",{staticClass:"row"},[n("div",{staticClass:"col-lg-4"},[t._v("总资产\n                            "),n("br"),n("div",{staticClass:"font-bold"},[t._v(t._s(t.total_value))])]),n("div",{staticClass:"col-lg-4"},[t._v("持仓盈亏\n                            "),n("br"),n("div",{staticClass:"font-bold"},[t._v(t._s(t.total_cost_value-t.cash_info.shares))])]),n("div",{staticClass:"col-lg-4"},[t._v("可用\n                            "),n("br"),n("div",{staticClass:"font-bold"},[t._v(t._s(t.cash_info.shares))])])])]),n("div",{staticClass:"main"},[n("table",[t._m(0),t._l(t.concat_new_stock,function(e,r){return n("tbody",[n("tr",[n("td",[t._v(t._s(e.stock_name)),n("br"),t._v(t._s(e.close?t.math_round(e.shares*e.close):1*e.shares||"-"))]),n("td",[t._v(t._s(e.shares)),n("br"),t._v(t._s(e.shares))]),n("td",[t._v(t._s(e.close||"-")),n("br"),t._v(t._s(e.cost))]),n("td",[t._v(t._s(t.math_round(t.cal_profit_and_lost(e.cost,e.close,e.shares))||"-")),n("br"),t._v(t._s(t.persent_profit_and_lost(t.cal_profit_and_lost(e.cost,e.close,e.shares),e.cost*e.shares)))])])])})],2)]),n("div",{staticClass:"table-foot"},[t._v("共持有"+t._s(this.concat_new_stock.length)+"个证券")])])])])],1)},Ee=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("thead",{staticClass:"thead"},[n("tr",[n("th",[t._v("股票/市值")]),n("th",[t._v("持仓/可用")]),n("th",[t._v("现价/成本")]),n("th",[t._v("盈亏")])])])}],Pe=(n("f559"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",t._l(t.account_belong_list,function(e,r){return n("div",{staticClass:"nav-side",style:{width:t.width}},[n("div",{staticClass:"nav-item",on:{click:function(n){t.onClick(e)}}},[t._v(t._s(e.$account.name)+"-"+t._s(e.name))])])}))}),Ne=[],Ae={props:{width:["width"]},data:function(){return{account_belong_list:[],user_id:M.get("uinfo")[0].id,real:[]}},methods:{read_account_belong:function(){var t=this;y.post("account_belong/read",{where:{user_id:this.user_id},with:[{model:"account",relation:"has_one"}]}).then(function(e){t.account_belong_list=e.data})},onClick:function(t){this.$emit("getPerAccount",t)}},mounted:function(){this.read_account_belong()}},je=Ae,Se=(n("9750"),Object(l["a"])(je,Pe,Ne,!1,null,"486554dc",null)),Oe=Se.exports,Ie={components:{StockAccountNav:Oe},data:function(){return{perAccountStock:[],perAccountInfo:{},concat_new_stock:[],stock_code_list:[],real:{},cash_info:{}}},methods:{math_round:function(t){return M.math_round(t)},cal_profit_and_lost:function(t,e,n){return(e-t)*n},persent_profit_and_lost:function(t,e){return M.toPercent(t/e)},getPerAccount:function(t){var e=this;this.perAccountInfo=t,this.$insProgress.start(),y.post("trade/read",{where:{account_belong_id:t.id,account_id:t.account_id}}).then(function(t){e.perAccountStock=t.data}).then(function(t){e.get_code_list()}).then(function(t){var n=e.stock_code_list.indexOf("999999"),r=e.stock_code_list;-1!=n&&r.splice(n,1),y.api(r).then(function(t){e.real=t}).then(function(t){e.concat_stock_data(),e.$insProgress.finish()})})},concat_stock_data:function(){var t=this.perAccountStock,e=t.length,n=this.real,r=n.length;this.concat_new_stock=[];for(var s=0;s<e;s++){var a=t[s].stock_code;if(console.log("code",a),a.startsWith("6"))a+=".SH";else{if(!a.startsWith("0")&&!a.startsWith("3")){this.cash_info=t[s];var i=Ft()(t[s],{close:1});this.concat_new_stock.push(i);continue}a+=".SZ"}for(var o=0;o<r;o++){var c=n[o].ts_code.indexOf(a);if(0==c){var u=t[s],l=n[o];this.concat_new_stock.push(Ft()(u,l))}}}},get_code_list:function(){for(var t=this.perAccountStock,e=t.length,n=this.stock_code_list=[],r=0;r<e;r++){var s=t[r].stock_code;n.push(s)}console.log("this.stock_code_list",this.stock_code_list)}},computed:{total_value:function(){var t=M.sum_arr_by_props(this.concat_new_stock,"close","shares");return M.math_round(t)},total_cost_value:function(){var t=M.sum_arr_by_props(this.concat_new_stock,"cost","shares");return M.math_round(t)},total_cash_value:function(){}}},Te=Ie,qe=(n("ba0c"),Object(l["a"])(Te,xe,Ee,!1,null,"5a8dda9e",null)),Le=qe.exports,De={position:"fixed",show:!0,height:"1px"};r["a"].use($t.a,De),r["a"].use(Ct["a"]),r["a"].config.productionTip=!1;var Me=new Ct["a"]({routes:[{path:"/",component:mt},{path:"/stock_account",component:Le},{path:"/admin",component:jt,children:[{path:"stock",component:ie},{path:"trade",component:de},{path:"user",component:$e},{path:"account",component:ge}]}]});new r["a"]({render:function(t){return t(wt)},router:Me}).$mount("#app")},"64a9":function(t,e,n){},"6cb5":function(t,e,n){"use strict";var r=n("94d4"),s=n.n(r);s.a},"708f":function(t,e,n){},7456:function(t,e,n){"use strict";var r=n("e47a"),s=n.n(r);s.a},"879c":function(t,e,n){},"94d4":function(t,e,n){},9750:function(t,e,n){"use strict";var r=n("4f0c"),s=n.n(r);s.a},"9a8c":function(t,e,n){},a614:function(t,e,n){"use strict";var r=n("068a"),s=n.n(r);s.a},ba0c:function(t,e,n){"use strict";var r=n("10d5"),s=n.n(r);s.a},be01:function(t,e,n){"use strict";var r=n("9a8c"),s=n.n(r);s.a},bf96:function(t,e,n){},c4f2:function(t,e,n){},cc7f:function(t,e,n){"use strict";var r=n("bf96"),s=n.n(r);s.a},d847:function(t,e,n){},da65:function(t,e,n){"use strict";var r=n("d847"),s=n.n(r);s.a},dc27:function(t,e,n){"use strict";var r=n("ff92"),s=n.n(r);s.a},e04d:function(t,e,n){"use strict";var r=n("0609"),s=n.n(r);s.a},e47a:function(t,e,n){},f226:function(t,e,n){"use strict";var r=n("4aff"),s=n.n(r);s.a},f58b:function(t,e,n){},ff92:function(t,e,n){}});
//# sourceMappingURL=app.10dbc154.js.map